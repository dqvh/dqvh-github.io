<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Juego del Impostor</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Arial', sans-serif;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
            display: flex;
            justify-content: center;
            align-items: center;
            padding: 20px;
        }

        .container {
            background: white;
            border-radius: 20px;
            padding: 40px;
            box-shadow: 0 20px 40px rgba(0,0,0,0.1);
            text-align: center;
            max-width: 500px;
            width: 100%;
            min-height: 400px;
            display: flex;
            flex-direction: column;
            justify-content: center;
        }

        h1 {
            color: #333;
            margin-bottom: 30px;
            font-size: 2.5em;
            text-shadow: 2px 2px 4px rgba(0,0,0,0.1);
        }

        .setup-screen {
            display: block;
        }

        .game-screen {
            display: none;
        }

        .transfer-screen {
            display: none;
        }

        .voting-screen {
            display: none;
        }

        .results-screen {
            display: none;
        }

        input, select {
            width: 100%;
            padding: 15px;
            margin: 10px 0;
            border: 2px solid #ddd;
            border-radius: 10px;
            font-size: 16px;
            transition: all 0.3s ease;
        }

        input:focus, select:focus {
            outline: none;
            border-color: #667eea;
            box-shadow: 0 0 10px rgba(102, 126, 234, 0.3);
        }

        button {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            border: none;
            padding: 15px 30px;
            border-radius: 25px;
            font-size: 18px;
            font-weight: bold;
            cursor: pointer;
            margin: 10px 0;
            width: 100%;
            transition: all 0.3s ease;
            box-shadow: 0 5px 15px rgba(0,0,0,0.2);
        }

        button:hover {
            transform: translateY(-2px);
            box-shadow: 0 8px 25px rgba(0,0,0,0.3);
        }

        button:active {
            transform: translateY(0);
        }

        .role-card {
            background: #f8f9fa;
            border: 3px solid #ddd;
            border-radius: 15px;
            padding: 40px;
            margin: 20px 0;
            font-size: 24px;
            font-weight: bold;
            min-height: 200px;
            display: flex;
            flex-direction: column;
            justify-content: center;
            align-items: center;
        }

        .impostor-card {
            background: linear-gradient(135deg, #ff6b6b, #ee5a52);
            color: white;
            border-color: #ff4757;
            animation: pulse 2s infinite;
        }

        .innocent-card {
            background: linear-gradient(135deg, #51cf66, #40c057);
            color: white;
            border-color: #37b24d;
        }

        @keyframes pulse {
            0% { box-shadow: 0 0 0 0 rgba(255, 107, 107, 0.7); }
            70% { box-shadow: 0 0 0 10px rgba(255, 107, 107, 0); }
            100% { box-shadow: 0 0 0 0 rgba(255, 107, 107, 0); }
        }

        .timer {
            font-size: 48px;
            font-weight: bold;
            color: #ff4757;
            margin: 20px 0;
            text-shadow: 2px 2px 4px rgba(0,0,0,0.3);
        }

        .player-list {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 10px;
            margin: 20px 0;
        }

        .player-vote {
            background: #f8f9fa;
            border: 2px solid #ddd;
            border-radius: 10px;
            padding: 15px;
            cursor: pointer;
            transition: all 0.3s ease;
        }

        .player-vote:hover {
            background: #e9ecef;
            transform: scale(1.05);
        }

        .player-vote.selected {
            background: #667eea;
            color: white;
            border-color: #5a67d8;
        }

        .hidden {
            display: none;
        }

        .warning {
            background: #fff3cd;
            border: 1px solid #ffeaa7;
            color: #856404;
            padding: 15px;
            border-radius: 10px;
            margin: 15px 0;
            font-weight: bold;
        }

        .success {
            background: #d4edda;
            border: 1px solid #c3e6cb;
            color: #155724;
            padding: 15px;
            border-radius: 10px;
            margin: 15px 0;
            font-weight: bold;
        }

        .danger {
            background: #f8d7da;
            border: 1px solid #f5c6cb;
            color: #721c24;
            padding: 15px;
            border-radius: 10px;
            margin: 15px 0;
            font-weight: bold;
        }
    </style>
</head>
<body>
    <div class="container">
        <!-- Pantalla de configuraci√≥n -->
        <div class="setup-screen" id="setupScreen">
            <h1>üïµÔ∏è Juego del Impostor</h1>
            
            <input type="text" id="themeInput" placeholder="¬øQu√© tienen que adivinar? (ej: Animales, Comidas, Pel√≠culas)">
            
            <select id="playerCount">
                <option value="3">3 Jugadores</option>
                <option value="4">4 Jugadores</option>
                <option value="5" selected>5 Jugadores</option>
                <option value="6">6 Jugadores</option>
                <option value="7">7 Jugadores</option>
                <option value="8">8 Jugadores</option>
                <option value="9">9 Jugadores</option>
                <option value="10">10 Jugadores</option>
            </select>
            
            <button onclick="startGame()">üöÄ Comenzar Juego</button>
        </div>

        <!-- Pantalla de transferencia -->
        <div class="transfer-screen" id="transferScreen">
            <h2>üì± Pasar el Tel√©fono</h2>
            
            <div style="font-size: 100px; margin: 40px 0;">ü§ê</div>
            
            <div class="warning">
                <strong>¬°ATENCI√ìN!</strong><br>
                Pasa el tel√©fono al <span id="nextPlayerName">Jugador X</span><br>
                SIN que vea la pantalla
            </div>
            
            <p style="font-size: 18px; margin: 20px 0;">
                <strong id="receivingPlayer">Jugador X</strong>: Cuando tengas el tel√©fono en tus manos, presiona el bot√≥n para descubrir tu rol.
            </p>
            
            <button onclick="showPlayerRole()" style="background: #28a745;">üîç Descubrir Mi Rol</button>
        </div>

        <!-- Pantalla del juego -->
        <div class="game-screen" id="gameScreen">
            <h2 id="playerTitle">Jugador 1</h2>
            
            <div class="role-card" id="roleCard">
                <div id="roleText"></div>
                <div id="themeText"></div>
            </div>
            
            <div class="warning">
                <strong>¬°Memoriza tu rol!</strong><br>
                Cuando termines, presiona "Listo" para borrar la informaci√≥n y pasar el tel√©fono.
            </div>
            
            <button onclick="finishPlayerTurn()" id="finishButton" style="background: #dc3545;">‚úÖ Listo - Borrar y Continuar</button>
        </div>

        <!-- Pantalla de votaci√≥n -->
        <div class="voting-screen" id="votingScreen">
            <h2>‚è∞ ¬°Tiempo de Votaci√≥n!</h2>
            
            <div class="timer" id="timer">3:00</div>
            
            <p><strong>Tema:</strong> <span id="votingTheme"></span></p>
            
            <div class="warning">
                Discutan y voten por quien creen que es el IMPOSTOR
            </div>
            
            <div class="player-list" id="playerList"></div>
            
            <button onclick="showResults()" id="voteButton" style="background: #28a745;">Revelar Impostor üé≠</button>
        </div>

        <!-- Pantalla de resultados -->
        <div class="results-screen" id="resultsScreen">
            <h2>üé≠ Resultados</h2>
            
            <div id="resultsContent"></div>
            
            <button onclick="resetGame()">üîÑ Jugar de Nuevo</button>
        </div>
    </div>

    <script>
        let gameData = {
            theme: '',
            playerCount: 5,
            currentPlayer: 1,
            impostorIndex: -1,
            players: [],
            gameTimer: null,
            timeLeft: 180, // 3 minutos
            selectedPlayer: -1
        };

        function startGame() {
            const theme = document.getElementById('themeInput').value.trim();
            if (!theme) {
                alert('¬°Por favor ingresa un tema!');
                return;
            }
            
            gameData.theme = theme;
            gameData.playerCount = parseInt(document.getElementById('playerCount').value);
            gameData.currentPlayer = 1;
            gameData.impostorIndex = Math.floor(Math.random() * gameData.playerCount) + 1;
            gameData.players = [];
            
            // Crear lista de jugadores
            for (let i = 1; i <= gameData.playerCount; i++) {
                gameData.players.push(`Jugador ${i}`);
            }
            
            console.log(`Impostor secreto: Jugador ${gameData.impostorIndex}`);
            
            showGameScreen();
        }

        function showGameScreen() {
            document.getElementById('setupScreen').style.display = 'none';
            
            // Mostrar directamente el rol del primer jugador
            document.getElementById('gameScreen').style.display = 'block';
            updatePlayerScreen();
        }

        function updatePlayerScreen() {
            const playerTitle = document.getElementById('playerTitle');
            const roleCard = document.getElementById('roleCard');
            const roleText = document.getElementById('roleText');
            const themeText = document.getElementById('themeText');
            const finishButton = document.getElementById('finishButton');
            
            playerTitle.textContent = `Jugador ${gameData.currentPlayer}`;
            
            if (gameData.currentPlayer === gameData.impostorIndex) {
                // Es el impostor
                roleCard.className = 'role-card impostor-card';
                roleText.textContent = 'üé≠ ERES EL IMPOSTOR';
                themeText.textContent = '¬°No sabes cu√°l es el tema! Trata de descubrirlo y que no te descubran.';
            } else {
                // Es inocente
                roleCard.className = 'role-card innocent-card';
                roleText.textContent = 'üë• ERES INOCENTE';
                themeText.textContent = `El tema es: ${gameData.theme.toUpperCase()}`;
            }
            
            if (gameData.currentPlayer === gameData.playerCount) {
                finishButton.textContent = '‚úÖ Listo - Iniciar Votaci√≥n';
            } else {
                finishButton.textContent = '‚úÖ Listo - Borrar y Continuar';
            }
        }

        function finishPlayerTurn() {
            if (gameData.currentPlayer < gameData.playerCount) {
                // Ir a la pantalla de transferencia
                showTransferScreen();
            } else {
                // √öltimo jugador, iniciar votaci√≥n
                startVoting();
            }
        }

        function showTransferScreen() {
            document.getElementById('gameScreen').style.display = 'none';
            document.getElementById('transferScreen').style.display = 'block';
            
            const nextPlayer = gameData.currentPlayer + 1;
            document.getElementById('nextPlayerName').textContent = `Jugador ${nextPlayer}`;
            document.getElementById('receivingPlayer').textContent = `Jugador ${nextPlayer}`;
        }

        function showPlayerRole() {
            gameData.currentPlayer++;
            document.getElementById('transferScreen').style.display = 'none';
            document.getElementById('gameScreen').style.display = 'block';
            updatePlayerScreen();
        }

        function nextPlayer() {
            // Esta funci√≥n ya no se usa, reemplazada por finishPlayerTurn
            finishPlayerTurn();
        }

        function startVoting() {
            document.getElementById('gameScreen').style.display = 'none';
            document.getElementById('votingScreen').style.display = 'block';
            
            document.getElementById('votingTheme').textContent = gameData.theme;
            
            // Crear botones de votaci√≥n
            const playerList = document.getElementById('playerList');
            playerList.innerHTML = '';
            
            for (let i = 1; i <= gameData.playerCount; i++) {
                const playerDiv = document.createElement('div');
                playerDiv.className = 'player-vote';
                playerDiv.textContent = `Jugador ${i}`;
                playerDiv.onclick = () => selectPlayer(i, playerDiv);
                playerList.appendChild(playerDiv);
            }
            
            // Iniciar temporizador
            startTimer();
        }

        function selectPlayer(playerNum, element) {
            // Remover selecci√≥n anterior
            document.querySelectorAll('.player-vote').forEach(div => {
                div.classList.remove('selected');
            });
            
            // Seleccionar nuevo jugador
            element.classList.add('selected');
            gameData.selectedPlayer = playerNum;
        }

        function startTimer() {
            gameData.timeLeft = 180; // 3 minutos
            const timerElement = document.getElementById('timer');
            
            gameData.gameTimer = setInterval(() => {
                const minutes = Math.floor(gameData.timeLeft / 60);
                const seconds = gameData.timeLeft % 60;
                timerElement.textContent = `${minutes}:${seconds.toString().padStart(2, '0')}`;
                
                if (gameData.timeLeft <= 0) {
                    clearInterval(gameData.gameTimer);
                    timerElement.textContent = '¬°TIEMPO!';
                    setTimeout(showResults, 2000);
                }
                
                gameData.timeLeft--;
            }, 1000);
        }

        function showResults() {
            clearInterval(gameData.gameTimer);
            
            document.getElementById('votingScreen').style.display = 'none';
            document.getElementById('resultsScreen').style.display = 'block';
            
            const resultsContent = document.getElementById('resultsContent');
            let html = `<h3>üé≠ El impostor era: <span style="color: #ff4757;">Jugador ${gameData.impostorIndex}</span></h3>`;
            
            if (gameData.selectedPlayer === gameData.impostorIndex) {
                html += '<div class="success">üéâ ¬°Los inocentes ganaron! Encontraron al impostor.</div>';
            } else if (gameData.selectedPlayer === -1) {
                html += '<div class="warning">‚è∞ ¬°Se acab√≥ el tiempo! El impostor gan√≥ por defecto.</div>';
            } else {
                html += '<div class="danger">üòà ¬°El impostor gan√≥! No lo descubrieron.</div>';
                html += `<p>Votaron por: <strong>Jugador ${gameData.selectedPlayer}</strong></p>`;
            }
            
            html += `<p><strong>Tema:</strong> ${gameData.theme}</p>`;
            
            resultsContent.innerHTML = html;
        }

        function resetGame() {
            // Resetear datos
            gameData = {
                theme: '',
                playerCount: 5,
                currentPlayer: 1,
                impostorIndex: -1,
                players: [],
                gameTimer: null,
                timeLeft: 180,
                selectedPlayer: -1
            };
            
            // Mostrar pantalla inicial
            document.getElementById('resultsScreen').style.display = 'none';
            document.getElementById('setupScreen').style.display = 'block';
            
            // Limpiar campos
            document.getElementById('themeInput').value = '';
            document.getElementById('playerCount').value = '5';
        }

        // Prevenir que se vea el contenido al cambiar de pesta√±a
        document.addEventListener('visibilitychange', function() {
            if (document.hidden) {
                // Opcional: pausar el juego si se cambia de pesta√±a
            }
        });
    </script>
</body>
</html>
